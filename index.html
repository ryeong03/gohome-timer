<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„¸ë ¹ì´ì˜ í‡´ê·¼ íƒ€ì´ë¨¸ ğŸ¬</title>
    <style>
        :root {
            --bg-color: #1e272e;
            --main-blue: #0fbcf9;
            --accent-yellow: #ffd32a;
        }
        body {
            background-color: var(--bg-color);
            color: #d2dae2;
            font-family: 'Apple SD Gothic Neo', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            transition: background-color 0.5s ease;
        }
        h1 {
            font-size: 2.5rem;
            color: #808e9b;
            margin-bottom: 10px;
            user-select: none;
        }
        #dolphin-btn {
            cursor: pointer;
            font-size: 3rem;
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: inline-block;
        }
        #target-display {
            background: rgba(255, 255, 255, 0.05);
            padding: 8px 20px;
            border-radius: 30px;
            font-size: 1.1rem;
            margin-bottom: 30px;
            color: #4bcffa;
            border: 1px solid rgba(15, 188, 249, 0.2);
        }
        #timer {
            color: var(--main-blue);
            font-size: 8rem;
            font-weight: 900;
            letter-spacing: -2px;
            text-shadow: 0 0 30px rgba(15, 188, 249, 0.3);
        }
        .message {
            font-size: 1.4rem;
            margin-top: 25px;
            color: var(--accent-yellow);
            font-weight: 500;
        }
        #admin-panel {
            display: none;
            position: absolute;
            bottom: 50px;
            padding: 25px;
            border-radius: 20px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid var(--main-blue);
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            animation: slideUp 0.4s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .admin-inputs { display: flex; gap: 12px; align-items: center; }
        input {
            background: #2f3542;
            border: 1px solid #57606f;
            color: white;
            padding: 12px;
            border-radius: 10px;
            outline: none;
            width: 70px;
            text-align: center;
        }
        input[type="password"] { width: 110px; }
        button {
            cursor: pointer;
            background: var(--main-blue);
            border: none;
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: bold;
            transition: 0.2s;
        }
        button:hover { background: #4bcffa; transform: translateY(-2px); }
    </style>
</head>
<body>

    <h1>í‡´ê·¼ê¹Œì§€ ë‚¨ì€ ì‹œê°„ <span id="dolphin-btn">ğŸ¬</span></h1>
    <div id="target-display">ğŸ¯ ë¡œë”© ì¤‘...</div>
    <div id="timer">0ì´ˆ</div>
    <div class="message" id="msg">ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤!! ! ğŸ•µï¸â€â™€ï¸</div>

    <div id="admin-panel">
        <h3 style="color: var(--accent-yellow); margin: 0 0 15px 0; font-size: 1rem;">ğŸ›  ì„¸ë ¹ ì „ìš© íƒ€ì„ ë¦¬í”Œë ˆì´ì„œ</h3>
        <div class="admin-inputs">
            <input type="number" id="hour" placeholder="ì‹œ" min="0" max="23">
            <input type="number" id="minute" placeholder="ë¶„" min="0" max="59">
            <input type="password" id="pw" placeholder="ë¹„ë°€í‚¤">
            <button onclick="updateTime()">SET</button>
        </div>
    </div>

    <script>
        let clickCount = 0;
        let clickTimer = null;
        const dolphinBtn = document.getElementById('dolphin-btn');
        const adminPanel = document.getElementById('admin-panel');
        
        //  Railway ë°°í¬ ì™„ë£Œ í›„ ì—¬ê¸°ì— ì‹¤ì œ ì£¼ì†Œ !
        const API_URL = "https://your-project-name.up.railway.app"; 

        //  ëŒê³ ë˜ 2ë²ˆ í´ë¦­: ê´€ë¦¬ì ëª¨ë“œ ì†Œí™˜
        dolphinBtn.addEventListener('click', () => {
            clickCount++;
            dolphinBtn.style.transform = "scale(1.4) rotate(-15deg)";
            setTimeout(() => { dolphinBtn.style.transform = "scale(1) rotate(0deg)"; }, 150);

            if (clickCount === 2) {
                const isHidden = adminPanel.style.display === 'none' || adminPanel.style.display === '';
                adminPanel.style.display = isHidden ? 'block' : 'none';
                clickCount = 0;
            }
            clearTimeout(clickTimer);
            clickTimer = setTimeout(() => { clickCount = 0; }, 800);
        });

        // ê´€ë¦¬ì ì‹œê°„ ì¡°ì‘ í•¨ìˆ˜
        async function updateTime() {
            const hour = document.getElementById('hour').value;
            const minute = document.getElementById('minute').value;
            const password = document.getElementById('pw').value;

            if(!hour || !minute || !password) return alert("ì „ë¶€ ë‹¤ ì…ë ¥í•´ì¤˜ìš”!!");

            try {
                const response = await fetch(`${API_URL}/api/admin/set-time`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        hour: parseInt(hour), 
                        minute: parseInt(minute), 
                        password: password 
                    })
                });

                const result = await response.json();
                if (response.ok) {
                    alert(result.message);
                    adminPanel.style.display = 'none';
                } else {
                    alert(result.detail);
                }
            } catch (e) {
                alert("ì„œë²„ ì—°ê²° ì‹¤íŒ¨!! ì£¼ì†Œë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”!! !");
            }
        }

        // ì‹¤ì‹œê°„ íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸ (H/M/S í¬ë§· ì ìš©)
        setInterval(async () => {
            try {
                const response = await fetch(`${API_URL}/api/clock-out`);
                const data = await response.json();
                let seconds = data.seconds_left;
                
                document.getElementById("target-display").innerText = `ğŸ¯ ì˜¤ëŠ˜ì˜ íƒˆì¶œ ëª©í‘œ: ${data.target_time}`;

                if (seconds <= 0) {
                    document.getElementById("timer").innerText = "FREEDOM!! !";
                    document.getElementById("timer").style.color = "#ff3f34";
                    document.getElementById("msg").innerText = "ë…¸íŠ¸ë¶ ë˜ì§€ê³  ë‹¹ì¥ ëŸ° í•˜ì„¸ìš”!!! ğŸƒâ€â™€ï¸ğŸ’¨âœ¨";
                    document.body.style.backgroundColor = "#2d3436";
                } else {
                    const h = Math.floor(seconds / 3600);
                    const m = Math.floor((seconds % 3600) / 60);
                    const s = seconds % 60;

                    let timeString = "";
                    if (h > 0) timeString += `${h}ì‹œê°„ `;
                    if (m > 0 || h > 0) timeString += `${m}ë¶„ `;
                    timeString += `${s}ì´ˆ`;

                    document.getElementById("timer").innerText = timeString;
                    document.getElementById("msg").innerText = "ì‹œê°„ì€ íë¦…ë‹ˆë‹¤!! ì¡°ê¸ˆë§Œ ë” ì¡´ë²„!!! â³ğŸ”¥";
                    document.getElementById("timer").style.color = "#0fbcf9";
                    document.body.style.backgroundColor = "#1e272e";
                }
            } catch (error) {
                document.getElementById("timer").innerText = "OFFLINE";
                document.getElementById("msg").innerText = "ì„œë²„ê°€ ì„¸ë ¹ë‹˜ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘... ğŸš¨";
            }
        }, 1000);
    </script>
</body>
</html>